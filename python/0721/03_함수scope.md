## 함수 Scope

+ 함수 스코프

  + 함수는 코드 내부에 **지역 스코프(local scope)**를 생성하면 그 외의 공간인 **전역 스코프(global scope)**로 구분

  + 함수만 스코프를 가짐. if나 for도 스코프를 가지지 않음.

  + 스코프

    + 전역 스코프: 코드 어디에서든 참조할 수 있는 공간

    + 지역 스코프: 함수가 만든 스코프.  함수 내부에서만 참조 가능

  + 변수
  
    + 전역 변수(global variable): 전역 스코프에 정의된 변수
  + 지역 변수(local variable): 지역 스코프에 정의된 변수

+ 변수 수명주기(lifecycle)

  + 변수는 각자의 수명주기가 존재

    + 빌트인 스코프(built-in scope)
      + 파이썬이 실행된 이후부터 영원히 유지
    + 전역 스코프
      + 모듈이 호출된 시점 이후 혹은 인터프리터가 끝날때까지 유지
    + 지역 스코프 
      + 함수가 호출될 때 생성되고 함수가 종료될 때

  + 함수 스코프 예시

    ```
    def func():
    	a = 20
    	print('local', a)
    	
    func()
    print('gloal',a)
    ```
    
    > a는 함수 내에서 할당 되었으므로 지역 스코프에서만 존재. 함수가 종료되며 사라짐

+ 이름 검색 규칙

  + 파이썬에서 사용되는 이름(식별자)들은 이름공간에 저장되러있음
  + 다음 순서로 이름을 찾아 나감 `LEGB Rule`라고 부름
    + Local scope: 함수
    + Enclosed scope : 특정 함수의 상위 함수
    + Global scop: 함수 밖의 변수, `import` 모듈
    + Built-in scope : 파이썬 안에 내장되어 있는 함수 또는 속성
  + 즉 함수 내에서는 바깥 스코프의 변수에 접근 가능하나 수정은 할수 없음

+ global

  + 현재 코드 블록 전체에 적용되며 나열된 식별자(이름)들이 전역 변수 임을 나타냄
    + `global`에 나열된 이름은 같은 코드 블록에서 `global` 앞에 등장할 수 없음
    + `global`에 나열된 이름은 매개 변수, for 루프대상,  클래스/함수 정의등으로 정의되지 않아야 함

+ nonlocal

  + 전역을 제외하고 가장 가까운 (둘러 싸고 있는) 스코프의 변수를 연결하도록 함
    + `nonlocal`에 나열된 이름은 같은 코드 블록에서 `nonlocal` 앞에 등장할 수 없음
    + `nonlocal` 은 이름공간 상에 존재하는 변수만 가능
    + `nonlocal` 에 나열된 이름은 매개변수, for 루프 대상, 클래스/함수 정의 등으로 정의되지 않아야 함
  + `global` 과는 달리 이미 존재하는 이름과의 연결만 가능함

+ 주의

  + 기본적으로 함수에서 선언된 변수는 `local scope`에 생성되며 함수 종료 시 사라짐
  + 해당 스코프에 변수가 없는 경우 `LEGB rule`에 의해 이름을 검색함
    + 변수에 접근은 가능하지만 해당 변수를 수정할 수는 없음
    
    + 값을 할당하는 경우 해당 스코프의 이름공간에 새롭게 생성되기 때문
    
    + 단 함수 내에서 필요한 상위 스코프 변수는 인자로 넘겨서 활용할것 
    
      > 클로저 제외- 클로저란 어떤 함수 내부에 중첩된 형태로써 외부 스코프 변수에 접근 가능한 함수
  + 상위 스코프에 있는 변수를 수정하고 싶다면 `global`, `nonlocal` 키워드를 활용 가능
    + 단 코드가 복잡해지면서 변수의 변경을 추적하기 어렵고 예기치 못한 오류가 발생
    + 가급적 사용하지 않는 것을 권장하며 함수로 값을 바꾸고자 한다면 항상 입자로 넘기고 리턴 값을 사용하는 것을 추천 

