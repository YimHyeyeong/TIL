## The Django Authentication System

* The Django Authentication System

* Authentication & Authorization

  * Authentication (인증)
    * 신원 확인
    * 사용자가 자신이 누구인지 확인하는 것
  * Authorization(권한, 허가)
    * 권한 부여
    * 인증된 사용자가 수행할 수 있는 작업을 결정

* 두번째 앱 생성하기

  ```
  $ python manage.py startapp accounts
  ```

  * app이름이 반드시 accounts 일 필요는 없음
  * 단, auth와 관련해 django 내부적으로 accounts라는 이름으로 사용되고 있기 때문에 되도록 accounts로 지정하는 것을 권장







## 쿠기와 세션

* HTTP

  * Hyer Text Transfer Protocol

* HTTP 특징

  * 비연결지향 (connectionless)
    * 서버에 요청에 대한응답을 보낸 후 연결을 끊음
  * 무상태(stateless)
    * 연결을 끊는 순간 클라이언트와 서버 간의 통신이 끝나며 상태 정보가 유지되지 않음
    * 클라이언트와 서버가 주고 받는 메시지들은 서로 완전히 독립적임
  * **클라이언트와 서버의 지속적인 관계ㅒ를 유지하기 위해 쿠키와 세션이 존재**

* 쿠키의 개념

  * 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각
  * 사용자가 웹사이트를 방문할 경우 해당 웹사이트의 서버를 통해 사용자가 컴퓨터에 설치되는 작은 기록 정보 파일
    * 브라우저(클라이언트)는 쿠키를 KEY-VALUE의 데이터 형식으로 저장
    * 이렇게 쿠키를 저장해 놓았다가 동일한 서버에 재요청 시 저장된 쿠키를 함께 전송
  * HTTP 쿠키는 상태가 있는 세션을 만들어 줌
  * 쿠키는 두 요청이 동일한 브라우저에서 들어왔는지 아닌지를 판단할 때 주로 사용
    * 이를 이용해 사용자의 로그인 상태를 유지할 수 있음
    * 상태가 없는 HTTP 프로토콜에서 상태 정보를 기억 시켜주기 때문
  * 웹 페이지에 접속하면 요청한

* 쿠키의 사용 목적

  1. 세션 관리
     * 로그린, 아이디 자동 완성, 공지 하루 안보기, 팝업 체크, 장바구니 등의 정보 관리
  2. 개인화
     * 사용자 선호, 테마 등의 설정
  3. 트래킹
     * 사용자 행동을 기록 및 분석

* 세션

  * 사이트와 특정 브라우저 사이의 "상태"를 유지시키는 것

  * 클아이언트가 서버에 접속하면 서버가 특정 session id를 발급하고 클라이언트는 밝브 받은 session id를 쿠키에 저장

    * 클라이언트가 다시 

    > 쿠키안에 담겨서 저장되고 전송됨

* 쿠키 lifetime (수명)

  * 쿠키의 수명은 두 가지 방법으로 정의 될 수 있음

  1. Session cookies
     * 현재 세션이 종료되면 삭제됨
     * 브라우저가 현

* Session in Django

  * Django의 세션은 미들웨어를 통해 구현됨



## 로그인

* 로그인
  * 로그인은 Session을 Create하는 로직과 같음
  * Django는 우리가 session의 메커니즘에 생각하지 않게끔 도움을 줌
  * 이를 위해 인증에 관한 built-in forms를 제공
* AuthenticationForm
  * 사용자 로그인을 위한 form
  * request를 첫번째 인자로 취함
* get_user()
  * AuthenticationForm의 인스턴스 메서드
  * user



## 로그인 사용자에 대한 접근 제한

* Limiting access to logged-in users
  * 로그인 사용자에 대한 엑세스 제한 2가지 방법
    1. The raw way
       * is



로그인 : 입력 > 검증> 세션아이디 > DB (그래서 authenticationform 은 일반폼이다,...? 그냥 인증만 하는 거고 id를 저장하지 않음 저장하하는 건 로그인함수)보통 디비를 건드는것이 모델폼임 근데 이 폼은 직접적으로 저장하는게 아니라서 일반폼임

일반폼은 인자를 넣는게 모델폼이랑 달라서 구분해줘야함



로그인하면 쟝고가 user에 유저정보를 넣어주고 로그아웃하면 anonymoususer정보를 넣음 이를 is_authenticated 속성이 t f 반환 유저클래스와 anony클래스가 따로 구현되어잇어서 가능한것





next 파라미터 그거 a or b 단축평가 생각 



일반 폼은 2개 있다 authen~ / passch~

일반폼은 .save() 몼쓴다 그래서 로그인 함수 쓰는거고 모델 폼은 저장하고 유저정보는 리턴값으로 돌려줌

유저정보수정할때는 리퀘스트의 유저정보가 담겨잇어서 피케이필요업ㅇ음



모델폼과 일반폼 차이 ㅍ모델정보가 들어가느냐 안들어가느냐 차이

일반폼은 거즌 세이브안되는데 패스워드 체인지는 상위 클래스에서 세이브를 정의해줘서 사용할수있음

비밀번호변경하면 세션값이 달ㄹㅏ져서 로그인풀림 그걸 처리해줌해쉬함수사욧ㅇ해서